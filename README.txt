Do mapping with dmel r5.57

Overall
- Helpful to rule out rs as well as confirming it
- Need to come up with set of genes to look in
... based on expression cut offs
... number of reads supporting intron being spliced
... length of introns
... presence in graveley study
- trend towards global statistics instead of individual examples


Sequence Motifs
- Figure out what a bit score for an individual sequence means
... try summing up information content of all characters of equal or greater probability???
- Might want to cut off low scoring annotated motifs before including in consensus motif
- Develop background model of rs site motifs
... look around all AG dinucleotides in long introns
... [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.1632356965463115e-06, 1.5489707089638936e-05, 7.744853544819468e-06, 1.807132493791209e-05, 9.29382425378336e-05, 0.00017296839583430144, 0.00025558016697904245, 0.0004621095948408949, 0.0008751684505645998, 0.001324369956164129, 0.0021169266355839877, 0.0031857164247690744, 0.004445545934726374, 0.005480774691883909, 0.008132096222060441, 0.010693061127547412, 0.013519932671406517, 0.016367457158051806, 0.020774278825054084, 0.024682848247339642, 0.028774712536852595, 0.03366171512363368, 0.03681645213422347, 0.04076890905992968, 0.04373776958544381, 0.045978613877744906, 0.04664983451829593, 0.04789159270331531, 0.04728491250897112, 0.04718422941288847, 0.045242852790987054, 0.04445287772941547, 0.04218621725863164, 0.04073018479220558, 0.03874233904903525, 0.03583027411618313, 0.033341594510447804, 0.030561192087857618, 0.027458087434233284, 0.023856730535892233, 0.020634871461247335, 0.01722971751937504, 0.014253112140316094, 0.01183671783433242, 0.00970171987381052, 0.00760802779886099, 0.006056475472048823, 0.004866349643994899, 0.003549724541375589, 0.002881085518672842, 0.0020394781001357933, 0.001621256008715542, 0.0012804824527434854, 0.0008958213933507851, 0.0005886088694062795, 0.0004362934163581633, 0.0002529985491307693, 0.00014457059950329673, 9.551986038610677e-05, 2.581617848273156e-05, 5.679559266200943e-05, 3.872426772409734e-05, 3.356103202755103e-05, 4.9050739117189964e-05, 1.5489707089638936e-05, 2.32345606344584e-05, 2.5816178482731558e-06, 2.5816178482731558e-06, 0.0, 0.0, 0.0]
... centered around 387354 AGs in introns lenght greater than 10000.

... [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.025519647622112e-07, 9.392879177784928e-07, 2.281127800319197e-06, 4.428071612384323e-06, 9.124511201276787e-06, 1.610207859048845e-05, 3.287507712224725e-05, 5.5686355125439216e-05, 0.00010828647852103482, 0.00019483515094491022, 0.0003380094664120034, 0.0005518987436889916, 0.0008469693338596924, 0.0013187602365610038, 0.0019394953662243337, 0.0027899534837786317, 0.00383457583233657, 0.005180977970477912, 0.006817620075212809, 0.008739403154987606, 0.010868097944650178, 0.013395855915380356, 0.015801909008764093, 0.018363749712510806, 0.020967992556545804, 0.023385719656907646, 0.025826526403249186, 0.02799292689361115, 0.02992141917279865, 0.03175799542003211, 0.033431001385583865, 0.03495546567613836, 0.035997806896895974, 0.037300599238854745, 0.03803794025431086, 0.0386341197141237, 0.03882640536929178, 0.03858058030281032, 0.037947097694262855, 0.03685041195826234, 0.03548361385390638, 0.03365066057435578, 0.03180375216002675, 0.029821452101549368, 0.027754481946483667, 0.025805727885069803, 0.023946608727809657, 0.021824623137559788, 0.019908207417315155, 0.01799434119284735, 0.016165547616932625, 0.014243898721146082, 0.012592764745679745, 0.010725191997159593, 0.009184759812002865, 0.007795687165596728, 0.006516377021582421, 0.0054429051155498575, 0.004474633456308485, 0.003718104130532037, 0.0029937789619365646, 0.0024306087632342314, 0.001949827533319897, 0.0015157423313179794, 0.0011822951205066143, 0.006978640861117694, 0.0006828623162249643, 0.0005233175541908745, 0.0003758493510996512, 0.00025562049762400415, 0.0001913463672503044, 0.0001282798927708913, 9.527063166038998e-05, 7.4337929492755e-05, 4.911133970098977e-05, 3.1801605216214685e-05, 2.321382996795418e-05, 1.31500308488989e-05, 7.514303342227942e-06, 4.964807565400605e-06, 1.341839882540704e-06, 2.952047741589549e-06, 2.012759823811056e-06, 1.7443918473029152e-06, 2.5494957768273376e-06, 8.051039295244224e-07, 1.2076558942866336e-06, 1.341839882540704e-07, 1.341839882540704e-07, 0.0, 0.0, 0.0]
... every 5th nt in introns longer than 10000 nts
... unsure why large peak at 0.73 ??? Probably not important though...


Sawtooth
 - go forward here despite being unsure
 - increase temperature
 - Stick with current implementation now, improve if needed later
 - Look for overlaps between samples and time points
 - Need to determine exactly which set of genes to run this on!
   - Noticed higher false positive rates on 

Sequence

SJR

- incorporate PE read information to numbers
- seems that should be able to count excessively long insert length PE
... reads on equal footing as split reads
- eventualy need to incorporate graveley data

 - figure out why chrX:2108827-21152072 aligns improperly
 ... seems to be an indel close to the sites? Or a micro exon???
 - seems that there can sometimes be slight mapping issues
    ... get around by looking a few bases on each side for motif?

 - have read pair straddling these sites, indicative of other avoidable misses
 ... 2R	15461832	15488386	15476248	-
 ... 3R	25256963	25297372	25272648	+
 ... 2R	6878630	6987036	6940011	- (seems to be mappibility issues)
 ... 2R	2391194	2501609	2433805	+ (btw igv won't show very long pairs)
 ... 3L	14310438	14359847	14339217	+
 ... 2L	18320731	18383401	18333385	+
 ... 2L	4032770	4074513	4056254	+
 ... 3R	5701946	5756085	5718362	+  
 ... 3R	5701946	5756085	5727133	+  check 
 ... 3R	5701946	5756085	5745466	+  check read ID  1327:35050
 ... 11 total (counting one from below)


 - 3R	4906745	4982839	4918040 has no support but in expressed intron

 - has support in total rna-seq
 ... 3R	4270410	4303140	4289597	
 ... 2L	17197087	17251508	17226473	- 
 ... X	21082827	21152072	21109455	- and straddling read in 5 minute sample

- 2R	13163569	13238598	13193491	+ is an annotated 3'ss (ostensibly not in use though, easily detected)

- putative non-ratchet rs intron in middle of 3R:747,829-769,025

threshold = 0.8
novel [157, 68, 31, 34, 22, 18, 17, 16, 73] 436
gravely [17, 4, 7, 5, 6, 7, 11, 9, 92] 158
total [5366, 1732, 937, 561, 424, 291, 216, 150, 300] 9977

threshold = 0.85
novel [44, 25, 14, 15, 8, 6, 10, 10, 65] 197
gravely [17, 4, 7, 5, 6, 7, 11, 9, 92] 158
total [5366, 1732, 937, 561, 424, 291, 216, 150, 300] 9977

threshold = 0.87  # min score of a graveley site
novel [24, 15, 12, 9, 5, 6, 9, 8, 62] 150
gravely [17, 4, 7, 5, 6, 7, 11, 9, 92] 158
total [5366, 1732, 937, 561, 424, 291, 216, 150, 300] 9977

threshold = 0.9
novel   [16, 9, 9, 6, 3, 3, 6, 5, 52] 109
gravely [16, 3, 6, 4, 5, 5, 10, 8, 82] 139
total [5366, 1732, 937, 561, 424, 291, 216, 150, 300] 9977


BPs

 - Write software, ignoring inverted reads for now
 - Later cut things out based on intronic location or motif information


Combining Data

 - Lean towards high recovery rate in all individual analysis
 - Later filter based on agreement between data types
